digraph UserFlow {
    rankdir=TB;
    node [fontname="Arial", fontsize=11];
    edge [fontname="Arial", fontsize=10];

    start [label="Начало", shape=ellipse];
    end [label="Конец", shape=ellipse];

    v1 [label="Открытие приложения\n«Калькулятор реликвий»", shape=box];
    v2 [label="Главный экран\nСекция «Ваши сеты»\nСписок сохранённых сетов\nили «Нет добавленных сетов»\nКнопка «+ Добавить сет»", shape=box];
    v3 [label="Нажатие «Добавить сет»", shape=box];
    v4 [label="Модалка «Создание сета»\nКнопка «Выбрать персонажа»", shape=parallelogram];
    v5 [label="Нажатие «Выбрать персонажа»", shape=box];
    v6 [label="Список персонажей\nс иконками и именами", shape=parallelogram];
    v7 [label="Клик по персонажу", shape=box];
    v8 [label="Модалка артефактов\nsplash-art персонажа\n6 карточек: Голова, Перчатки,\nТело, Ботинки, Сфера, Веревка", shape=parallelogram];
    v9a [label="Клик «+» → выбор сета", shape=box];
    d4 [label="Сет\nвыбран?", shape=diamond];
    v_alert [label="Оповещение:\n«Сначала выберите сет»", shape=parallelogram];
    v9b [label="Клик «Главный стат» → выбор стата", shape=box];
    v9c [label="Клик «—» подстата → выбор подстата,\nпроков (0–5), качества", shape=box];
    d5 [label="Главный стат\nвыбран?", shape=diamond];
    v10 [label="Отображение шанса\nвыпадения на карточке", shape=parallelogram];
    v10a [label="Шанс не отображается", shape=parallelogram];
    v11 [label="Нажатие «Сохранить сет»", shape=box];
    v13 [label="Модалка «Название сета»\nПоле ввода", shape=parallelogram];
    v14 [label="Ввод названия\nНажатие «Сохранить»", shape=box];
    d2 [label="Название\nвведено?", shape=diamond];
    v15 [label="Оповещение:\n«Введите название сета»", shape=parallelogram];
    v16 [label="Сохранение сета\nЗакрытие модалок\nВозврат на главный экран", shape=box];
    v17 [label="Сет в списке\nс именем, фото персонажа,\nкнопкой «Удалить»", shape=parallelogram];
    v18 [label="Нажатие «Удалить»\nна карточке сета", shape=box];
    v19 [label="Удаление сета\nиз списка", shape=box];
    d3 [label="Действие\nпользователя?", shape=diamond];

    start -> v1 -> v2;
    v2 -> d3;
    d3 -> v3 [label="Добавить сет"];
    d3 -> v18 [label="Удалить"];
    d3 -> v2 [label="Просмотр"];
    v3 -> v4 -> v5 -> v6;
    v6 -> v7 -> v8;
    v8 -> v9a -> v8;
    v8 -> v9b;
    v8 -> v9c;
    v9b -> d4;
    v9c -> d4;
    d4 -> v_alert -> v8 [label="Нет"];
    d4 -> v9b [label="Да (гл. стат)"];
    d4 -> v9c [label="Да (подстат)"];
    v9b -> d5;
    v9c -> d5;
    d5 -> v10 [label="Да"];
    d5 -> v10a [label="Нет"];
    v10 -> v11;
    v10a -> v11;
    v11 -> v13;
    v13 -> v14 -> d2;
    d2 -> v15 -> v14 [label="Нет"];
    d2 -> v16 [label="Да"];
    v16 -> v17 -> v2;
    v18 -> v19 -> v2;
    v2 -> end [label="Закрыть вкладку"];
}
